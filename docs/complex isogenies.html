<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>The classical modular polznomial</title>

  <!-- MathJax configuration -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']]
      }
    };
  </script>

  <!-- MathJax -->
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <link rel="stylesheet" href="style.css">
</head>

<body>

The purpose of this post is to classify all complex isogenies of some given degree $l$.
<br> First, we show that up to isomorphism, isogenies of prime degree $l$ are just quotients maps
$$
E_{l\tau} \to E_{\tau}.
$$
Such a quotient map will be written $\phi_\tau$ (whenever $l$ is understood).
<h3>Proposition 1</h3>
Let $\tau \in \mathcal{H}$ and let $\Lambda \subseteq \Lambda_\tau$ be a sublattice of prime index $l$ (primality actually necessary?). Then there exists $\omega_1\in \Lambda_\tau\setminus \Lambda, \omega_2\in \Lambda$ such that
\begin{align}
    \mathcal{B}&:=\{\omega_1, \omega_2\} \text{ is a basis of }\Lambda_\tau, \label{cond 1} \\
    \mathcal{B}'&:=\{lw_1,w_2\} \text{ is a basis of }\Lambda. \label{cond 2}
\end{align}
<br>
The proofs follow at the end of the post.
<h3>Definition</h3>
    We say that two isogenies $E_1\to E_2$, $E_1'\to E_2'$ are isomorphic if there exists isomorphisms $E_1 \xrightarrow{\sim} E_1'$, $E_2 \xrightarrow{\sim} E_2'$ such that the following diagram commutes
<br>
<!-- https://q.uiver.app/#q=WzAsNCxbMCwwLCJFXzEiXSxbMSwwLCJFXzIiXSxbMCwxLCJFXzEnIl0sWzEsMSwiRV8yJyJdLFswLDFdLFswLDJdLFsyLDNdLFsxLDNdXQ== -->
<iframe class="quiver-embed" src="https://q.uiver.app/#q=WzAsNCxbMCwwLCJFXzEiXSxbMSwwLCJFXzIiXSxbMCwxLCJFXzEnIl0sWzEsMSwiRV8yJyJdLFswLDFdLFswLDJdLFsyLDNdLFsxLDNdXQ==&embed" width="304" height="304" style="border-radius: 8px; border: none;"></iframe>
<br>

<h3>Corollary 2</h3>
    Let $\phi:E \to E'$ be an $l$-isogeny. Then there exists $\tau\in \mathcal{H}$ such that $$\phi \cong \phi_\tau.$$
<br>
We can go a little further in this classification by avoiding repetitions of isomorphism classes of isogenies of the form $\phi_\tau$. Therefore we would like to understand under which conditions we have $\phi_\tau \cong \phi_{\tau'}$ for different $\tau,\tau'\in \mathcal{H}$.
<h3>Proposition 3</h3>
    Let $\tau,\tau' \in \mathcal{H}$. Then $$
    (\Lambda_{\tau},\Lambda_{l\tau}) \cong (\Lambda_{\tau'},\Lambda_{l\tau'}) \iff \exists \gamma \in \Gamma_0(l): \tau = \gamma \tau'.
    $$
<br>
The proof can be found on page \pageref{proof lattice classificaiton}.
<br>
In terms of isogenies, this is expressed by the fact that for all $\gamma\in \Gamma(1)$:
$$
     \phi_{\tau} \cong \phi_{\tau'}\iff \exists\gamma \in \Gamma_0(l): \tau= \gamma \tau'.   
$$

Moreover, in terms of moduli spaces, this means that the following map is a bijection
\begin{align}
    \Gamma_0(l) \setminus \mathcal{H} &\xrightarrow[]{\cong} \frac{\{\text{$l$-isogenies}\}}{\cong} \label{l-isogenies} \\
    [\tau] &\mapsto [\phi_\tau]. \nonumber
\end{align}
We then say that $Y_0(l):=\Gamma_0(l)\setminus \mathcal{H}$ is a moduli space of isogenies.

<h2>Proofs</h2>
<h3>Proof of the proposition 1</h3>
    Let $\omega_1,\omega_2\in \Lambda_\tau$. Then condition \ref{cond 1} holds if and only if there exists $\begin{pmatrix}
        a' & b'\\ c' & d'
    \end{pmatrix}\in SL_2(\mathbb{Z})$ such that 
    \begin{align*}
        \omega_1 &= a'\tau + b', \\
        \omega_2 &= c' \tau + d'.
    \end{align*}
    Let $\mathcal{B}':=\{\Tilde{\omega}_1,\Tilde{\omega}_2\}$ be any basis of $\Lambda$ and write $\Tilde{\omega}_1=x\tau + y$, $\Tilde{\omega}_2=z\tau + t$.
    
    Condition \ref{cond 2}, holds if and only if there exists $\begin{pmatrix}
        a & b \\ c& d
    \end{pmatrix} \in SL_2(\mathbb{Z})$ such that
    \begin{align*}
        l\omega_1 &= a\Tilde{\omega}_1+b\Tilde{\omega}_1 = (ax+bz)\tau+ay+bt,\\
        \omega_2 &= c\Tilde{\omega}_1+d\Tilde{\omega}_2=(cx+dz)\tau+ cy+dt .
    \end{align*}
    So \ref{cond 1} and \ref{cond 2} hold simultaneously if and only if \ref{cond 1} does and
    \begin{align*}
        la' &= ax+bz, ~~~ lb' = ay+bt, \\
        c' &= cx+dz, ~~~d' = cy+dt.
    \end{align*}
    This can be written in terms of matrices as
    $$
    \begin{pmatrix}
        l & 0\\ 0 & 1
    \end{pmatrix}
    \begin{pmatrix}
        a' & b'\\ c' & d'
    \end{pmatrix}
    =
    \begin{pmatrix}
        a & b\\ c & d
    \end{pmatrix}
    \begin{pmatrix}
        x & y\\ z & t
    \end{pmatrix}.
    $$
    Since $ \begin{pmatrix}
        l & 0\\ 0 & 1
    \end{pmatrix}$ is invertible, $\begin{pmatrix}
        a' & b'\\ c' & d'
    \end{pmatrix}$ is fully determined by the other variables, but it still has to hold that the matrix we will obtain will be in $SL_2(\mathbb{Z})$. In other words, conditions \ref{cond 1} and \ref{cond 2} are equivalent to \ref{cond 1} and the existence of a matrix $\begin{pmatrix}
        a & b\\ c & d
    \end{pmatrix}\in SL_2(\mathbb{Z})$ such that $$M:=\frac{1}{l}\begin{pmatrix}
        1 & 0\\ 0 & l
    \end{pmatrix}\begin{pmatrix}
        a & b\\ c & d
    \end{pmatrix}
    \begin{pmatrix}
        x & y\\ z & t
    \end{pmatrix}\in SL_2(\mathbb{Z}).$$
   Since $\det \begin{pmatrix}
        x & y\\ z & t
    \end{pmatrix}=l$ and $\det \begin{pmatrix}
        a & b\\ c & d
    \end{pmatrix}=1$, $\det M =1$. Therefore we just have to show that the entries are integers. We have
    $$M=\begin{pmatrix}
        \frac{1}{l}(ax+bz) & \frac{1}{l}(ay+bt) \\ cx+dz & cy+dt
    \end{pmatrix},$$
    so the bottom ones are integers. In addition since $xt-yz =l$, we have $(x,z)(y,t)|l$,
    meaning that $(x,z)=1,(y,t)=l$ or $(x,z)=l,(y,t)=1$ or $(x,z)=(y,t)=1$. 
    
    The first and the second cases are symmetric, so it suffices to find $a,b$ in the first and the third, which we can do all at once. So assume $(x,z)=1$.

    We want to find coprime numbers $a,b$ such that $ax+bz$ and $ay+bt$ are divisible by $l$. Therefore let us write $ax+bz=kl$ for some $k\in \mathbb{Z}$, and by lemma \ref{span}, $ax+bz=kl$ if and only if 
    \begin{align}
        a &= kla_0-(\alpha+kl\beta)z \label{ab}, \\
        b &= klb_0+(\alpha+kl\beta)x, \nonumber
    \end{align}
    where $a_0,b_0$ satisfy $a_0x+b_0z=1$ and $\alpha,\beta$ are integers.
    Therefore we automatically get
    \begin{align*}
        ay+bt&= kla_0y-(\alpha+kl\beta)yz+klb_0t+(\alpha+kl\beta)xt \\
        &=kl(a_0y-\beta yz+b_0t+\beta xt)+\alpha(xt-yz)
    \end{align*}
    which is divisible by $l$ since $xt-yz=l$.

    We now have to show that we can find such integers $k,\alpha,\beta$ giving rise to coprime $a,b$. Therefore we are looking for integers $k,\alpha,\beta$ such that there exists integers $u,v$ such that $au+bv=1$. Substituting the values of $a$ and $b$ from \ref{ab}, we get 
    $$
    au+bv = kl(a_0u+b_0v)+(\alpha+kl\beta)(xv-zu).
    $$
    Let us set $\alpha=1$, so that $kl$ and $\alpha+kl\beta$ are coprime. We then have 
    $$
    -\beta \cdot kl+1\cdot(1+kl\beta)=1.
    $$
    Therefore it suffices to find $u,v$ satisfying 
    \begin{align}
        a_0u+b_0v&=-\beta \label{eq n}, \\
        xv-zu&=1 \label{eq m}.
    \end{align}
    By lemma \ref{span}, \ref{eq n} holds if and only if $u$ is of the form $u=-\beta x-(\eta-\beta\epsilon)b_0$ and $v$ of the form $v=-\beta z+(\eta-\beta\epsilon)a_0$ for integers $\eta,\epsilon$. This then yields
    $$
    xv-zu = -\beta xz+(\eta-\beta \epsilon)a_0x+\beta xz+(\eta-\beta \epsilon)b_0z = \eta-\beta \epsilon.
    $$
    Setting $\eta = 1$, $\epsilon=0$, \ref{eq m} holds too and we are done. This gives $u=-\beta x-1b_0$, $v=-\beta z+a_0$. In sum, we are taking 
    \begin{align*}
        a=kla_0-(1+kl\beta)z,&~~~b= klb_0+(1+kl\beta)x.
    \end{align*}
    These give us
    $$ax+bz=kla_0x-(1+kl\beta)xz+klb_0z+(1+kl\beta)xz=kl,$$
    so $l|ax+bz$.
    These are coprime because 
    \begin{align*}
        au+bv &=-\beta kla_0x-kla_0b_0+(1+kl\beta)\beta xz+(1+kl\beta)b_0z\\
        &-klb_0\beta z+klb_0a_0-(1+kl\beta)\beta xz+(1+kl\beta)a_0x \\
        &=-kl\beta+1+kl\beta =1.
    \end{align*}

<h3>Proof of Proposition 3</h3>
    We have 
    \begin{align*}
    (\Lambda_{\tau},\Lambda_{l\tau}) \cong (\Lambda_{\tau'},\Lambda_{l\tau'})&\iff
    \exists \alpha \in \mathbb{C}^*: \alpha \Lambda_{\tau} = \Lambda_{\tau'}, \alpha \Lambda_{l\tau} = \Lambda_{l\tau'} \\
    &\iff \exists \gamma \in \Gamma(1): \tau = \gamma\tau', \alpha = c\tau'+d, \alpha \Lambda_{l\tau} = \Lambda_{l\tau'} \\
    &\iff \exists \gamma \in \Gamma(1): \tau = \gamma \tau',~~ (c\tau'+d) \Lambda_{l\gamma \tau'} = \Lambda_{l\tau'}\\
    &\iff \exists \gamma,\gamma'\in \Gamma(1):  \tau = \gamma \tau',~~
    l\gamma \tau' = \gamma' l\tau', c\tau'+d = c'l\tau'+d'.
    \end{align*}
    More specifically,
    \begin{align*}
        c\tau'+d = c'l\tau'+d'
        &\iff (lc'-c)\tau' = d-d'\\
        &\iff lc' = c, d=d' \\
        &\iff (lc',d') = 1, \text{ IWC }c=lc', d=d' \\
        &\iff l\nmid d',\text{ IWC } c=lc', d=d'.
    \end{align*}
    Therefore,
    \begin{align*}
(\Lambda_{\tau},\Lambda_{l\tau}) \cong (\Lambda_{\tau'},\Lambda_{l\tau'})
    &\iff \exists \gamma \in \Gamma(1): \tau = \gamma \tau',~~ l\nmid d', \exists a,b\in \mathbb{Z}\text{ coprime }: ad'-lbc'=1,\\
    &~~~~~~~~~~~~\gamma' l\tau' = l\begin{pmatrix}
        a & b \\ lc' & d'
    \end{pmatrix} \tau' = \begin{pmatrix}
        a & lb\\ c' & d'
    \end{pmatrix} l\tau' \\
    &\iff \exists\gamma\in \Gamma(1), \tau = \gamma \tau',~~ a,b\in \mathbb{Z}: ad'-lbc'=1,\\
    &~~~~~~~~~~~~\gamma'^{-1}\begin{pmatrix}
        a & lb \\ c'& d' 
    \end{pmatrix}\in \Gamma(1)_{l\tau'}.
    \end{align*}
    Now, either the stabilizer is trivial, or it makes the calculation trivial (if you want to see that calculations, explain to me how to use itemize in HTML).
    Therefore in any case, one must have $\gamma^{-1}\begin{pmatrix}
        a' & lb' \\ c& d 
    \end{pmatrix} = \pm I$. If $\gamma = \begin{pmatrix}
        -a' & -lb' \\ -c& -d 
    \end{pmatrix} $, then $c=d=0$, which contradicts that $\det \gamma =1$. Therefore,
    \begin{align*}
    &\exists \gamma \in \Gamma(1), a',b'\in \mathbb{Z}: a'd-lb'c=1, \gamma^{-1}\begin{pmatrix}
        a' & lb' \\ c& d 
    \end{pmatrix}\in \Gamma(1)_{\tau'} \\
    &\iff \exists \gamma\in \Gamma(1), a',b'\in \mathbb{Z}: a'd-lb'c=1, \gamma = \begin{pmatrix}
        a' & lb' \\ c& d
    \end{pmatrix}\\
    &\iff \gamma \in \Gamma^0(l).
    \end{align*}
    Finally,
    $$
    (\Lambda_{\tau/l},\Lambda_\tau) \cong (\Lambda_{\tau'/l},\Lambda_{\tau'}) \iff \exists \gamma \in \Gamma^0(l): \tau = \gamma \tau'.
    $$

  
</body>
